"use strict";(self.webpackChunkdocusaurus_code=self.webpackChunkdocusaurus_code||[]).push([[8847],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>c});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=p(n),c=r,h=u["".concat(s,".").concat(c)]||u[c]||m[c]||o;return n?a.createElement(h,l(l({ref:t},d),{},{components:n})):a.createElement(h,l({ref:t},d))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(67294),r=n(34334);const o="tabItem_Ymn6";function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,l),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(83117),r=n(67294),o=n(34334),l=n(72389),i=n(67392),s=n(7094),p=n(12466);const d="tabList__CuJ",m="tabItem_LNqP";function u(e){var t;const{lazy:n,block:l,defaultValue:u,values:c,groupId:h,className:k}=e,g=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),b=c??g.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),v=(0,i.l)(b,((e,t)=>e.value===t.value));if(v.length>0)throw new Error(`Docusaurus error: Duplicate values "${v.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const f=null===u?u:u??(null==(t=g.find((e=>e.props.default)))?void 0:t.props.value)??g[0].props.value;if(null!==f&&!b.some((e=>e.value===f)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${f}" but none of its children has the corresponding value. Available values are: ${b.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:N}=(0,s.U)(),[w,T]=(0,r.useState)(f),j=[],{blockElementScrollPositionUntilNextRender:x}=(0,p.o5)();if(null!=h){const e=y[h];null!=e&&e!==w&&b.some((t=>t.value===e))&&T(e)}const I=e=>{const t=e.currentTarget,n=j.indexOf(t),a=b[n].value;a!==w&&(x(t),T(a),null!=h&&N(h,String(a)))},P=e=>{var t;let n=null;switch(e.key){case"ArrowRight":{const t=j.indexOf(e.currentTarget)+1;n=j[t]??j[0];break}case"ArrowLeft":{const t=j.indexOf(e.currentTarget)-1;n=j[t]??j[j.length-1];break}}null==(t=n)||t.focus()};return r.createElement("div",{className:(0,o.Z)("tabs-container",d)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":l},k)},b.map((e=>{let{value:t,label:n,attributes:l}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:w===t?0:-1,"aria-selected":w===t,key:t,ref:e=>j.push(e),onKeyDown:P,onFocus:I,onClick:I},l,{className:(0,o.Z)("tabs__item",m,null==l?void 0:l.className,{"tabs__item--active":w===t})}),n??t)}))),n?(0,r.cloneElement)(g.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==w})))))}function c(e){const t=(0,l.Z)();return r.createElement(u,(0,a.Z)({key:String(t)},e))}},36227:(e,t,n)=>{n.d(t,{ZP:()=>s});var a=n(83117),r=(n(67294),n(3905)),o=n(65488),l=n(85162);const i={toc:[]};function s(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},i,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(o.Z,{groupId:"buildTool",mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"java_maven",label:"Java (Maven)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="pom.xml"',title:'"pom.xml"'},"...other code omitted... \n\n<build>\n  <plugins>\n    <plugin>\n      <groupId>org.apache.maven.plugins</groupId>\n      <artifactId>maven-compiler-plugin</artifactId>\n      <version>3.10.1</version>\n      <configuration>\n        \x3c!-- highlight-next-line --\x3e\n        <annotationProcessorPaths>\n          <path>\n            <groupId>org.babyfish.jimmer</groupId>\n            \x3c!-- highlight-next-line --\x3e\n            <artifactId>jimmer-apt</artifactId>\n            <version>${jimmer.version}</version>\n          </path>\n        </annotationProcessorPaths>\n      </configuration>\n    </plugin>\n  </plugins>\n</build>\n\n...other code omitted...\n"))),(0,r.kt)(l.Z,{value:"java_gradle",label:"Java (Gradle)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-groovy"},'dependencies {\n\n  ...other dependencies omitted...\n\n  annotationProcessor "org.babyfish.jimmer:jimmer-apt:${jimmerVersion}" \n}\n'))),(0,r.kt)(l.Z,{value:"kotlin_gradle",label:"Kotlin (Gradle.kts)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},'plugins {\n  // Add KSP plugin  \n  id("com.google.devtools.ksp") version "1.7.10-1.0.6"\n\n  ...other plugins omitted...\n}\n\ndependencies {\n\n  // Apply Jimmer\'s KSP code generator \n  // highlight-next-line\n  ksp("org.babyfish.jimmer:jimmer-ksp:${jimmerVersion}")\n\n  ...other dependencies omitted...\n}\n\n// Add generated code to compile path.\n// Gradle build works without this, but IntelliJ won\'t find generated code. \nkotlin {\n  sourceSets.main {\n    kotlin.srcDir("build/generated/ksp/main/kotlin") \n  }\n}\n'))),(0,r.kt)(l.Z,{value:"java_gradle_plugin",label:"Java (Gradle Plugin)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-groovy",metastring:'title="build.gradle"',title:'"build.gradle"'},'plugins {\n    // Starting from Gradle 7.0, you can use "latest.release" instead of a specific version number to represent the use of the latest version.\n    // You can also use the \'+\' character to indicate matching the latest version number starting from the \'+\' character.\n    id "tech.argonariod.gradle-plugin-jimmer" version "latest.release"\n\n    ...other plugins omitted...\n}\n\njimmer {\n    // Set the Jimmer dependency version, where you can also use version range expressions such as "latest.release" or "0.+"\n    version = "${jimmerVersion}"\n}\n'))),(0,r.kt)(l.Z,{value:"kotlin_gradle_plugin",label:"Kotlin (Gradle Plugin)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin",metastring:'title="build.gradle.kts"',title:'"build.gradle.kts"'},'plugins {\n    // Starting from Gradle 7.0, you can use "latest.release" instead of a specific version number to represent the use of the latest version.\n    id("tech.argonariod.gradle-plugin-jimmer") version "latest.release"\n    // You can also use the \'+\' character to indicate matching the latest version number starting from the \'+\' character.\n    // Add KSP plugin\n    id("com.google.devtools.ksp") version "1.7.10+"\n\n    ...other plugins omitted...\n}\n\njimmer {\n    // Set the Jimmer dependency version, where you can also use version range expressions such as "latest.release" or "0.+"\n    version = "${jimmerVersion}"\n}\n')))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"The first three: Standard configurations"),(0,r.kt)("li",{parentName:"ul"},"The last two: Community-provided ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/ArgonarioD/gradle-plugin-jimmer"},"Gradle plugin")," for further simplifying configurations"))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("a",{parentName:"p",href:"https://kotlinlang.org/docs/ksp-overview.html"},"KSP")," only supports gradle,\nIt has been proven that KSP's third-party Maven plug-in support cannot keep up with the version\niteration of 'kotlin/KSP' itself, and often encounters many problems during the upgrade process."),(0,r.kt)("p",{parentName:"admonition"},"Eventually, Jimmer dropped Maven support for Kotlin and asked Kotlin developers to use Gradle.")))}s.isMDXComponent=!0},9794:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>p,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>u});var a=n(83117),r=(n(67294),n(3905)),o=n(65488),l=n(85162),i=n(36227);const s={sidebar_position:4,title:"APT/KSP"},p=void 0,d={unversionedId:"overview/apt-ksp",id:"overview/apt-ksp",title:"APT/KSP",description:"Basic Concepts",source:"@site/docs/overview/apt-ksp.mdx",sourceDirName:"overview",slug:"/overview/apt-ksp",permalink:"/jimmer-doc/docs/overview/apt-ksp",draft:!1,editUrl:"https://github.com/babyfish-ct/jimmer-doc/edit/main/docs/overview/apt-ksp.mdx",tags:[],version:"current",lastUpdatedAt:1730114683,formattedLastUpdatedAt:"Oct 28, 2024",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"APT/KSP"},sidebar:"tutorialSidebar",previous:{title:"Overview \u2726",permalink:"/jimmer-doc/docs/overview/introduction"},next:{title:"Benchmark Report",permalink:"/jimmer-doc/docs/overview/benchmark"}},m={},u=[{value:"Basic Concepts",id:"basic-concepts",level:2},{value:"How to Use",id:"how-to-use",level:2},{value:"Where to Use",id:"where-to-use",level:2},{value:"Notes",id:"notes",level:2},{value:"Two Styles of Java Code",id:"two-styles-of-java-code",level:2},{value:"Integration with Lombok",id:"integration-with-lombok",level:2}],c={toc:u};function h(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"basic-concepts"},"Basic Concepts"),(0,r.kt)("p",null,"Jimmer heavily relies on the precompilation technology in the JVM ecosystem:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For Java, it's ",(0,r.kt)("inlineCode",{parentName:"p"},"APT"),", i.e., ",(0,r.kt)("a",{parentName:"p",href:"https://www.jetbrains.com/help/idea/annotation-processors-support.html"},"Annotation Processor Tool"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For Kotlin, it's ",(0,r.kt)("inlineCode",{parentName:"p"},"KSP"),", i.e., ",(0,r.kt)("a",{parentName:"p",href:"https://kotlinlang.org/docs/ksp-overview.html"},"Kotlin Symbol Processing")))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Some code generated by APT/KSP is necessary for using Jimmer."),(0,r.kt)("p",{parentName:"admonition"},"Therefore, if you open any Java/Kotlin project from the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/babyfish-ct/jimmer-examples"},"official examples")," in IntelliJ, you will find that some code that should have been automatically generated is missing. For this, you can choose any of the following methods:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"First, execute the ",(0,r.kt)("inlineCode",{parentName:"p"},"./mvnw install")," ",(0,r.kt)("em",{parentName:"p"},"(for Java examples only)")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"./gradlew build")," command in the directory of the project you want to open from the command line to complete the code generation, then open the project with IntelliJ.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Open the project directly with IntelliJ, ignore the IDE errors temporarily, and after the dependencies are downloaded, run the project's main method or unit test ",(0,r.kt)("em",{parentName:"p"},"(save-command/save-command-kt demonstrates features using unit tests)"),". All IDE errors will automatically disappear, and the application will start correctly.")))),(0,r.kt)("h2",{id:"how-to-use"},"How to Use"),(0,r.kt)(i.ZP,{mdxType:"Precompiler"}),(0,r.kt)("p",null,"For all projects in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/babyfish-ct/jimmer-examples"},"official examples"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"All Java examples have both ",(0,r.kt)("inlineCode",{parentName:"p"},"pom.xml")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"build.gradle"),", i.e., they support both Maven and Gradle."),(0,r.kt)("p",{parentName:"li"},"When opening these projects for the first time, IntelliJ will ask you how you want to open them, and you can make your choice."),(0,r.kt)("p",{parentName:"li"},"If you want to switch the opening method, exit IntelliJ, delete the hidden directory ",(0,r.kt)("inlineCode",{parentName:"p"},".idea")," in the project, and then open the project with IntelliJ again and reselect the method.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"All Kotlin examples only have the ",(0,r.kt)("inlineCode",{parentName:"p"},"build.gradle.kts")," file, i.e., they only support Gradle. The reason has been explained earlier."))),(0,r.kt)("p",null,"IntelliJ has some rash over-optimization measures for integrating annotation processors introduced via Maven, resulting in a better development experience when using Gradle with the IDE than with Maven."),(0,r.kt)("h2",{id:"where-to-use"},"Where to Use"),(0,r.kt)("p",null,"Business projects are rarely a single project, but more often split into multiple subprojects using build tools like Maven and Gradle."),(0,r.kt)("p",null,"So, in which subprojects should we use the configurations mentioned earlier?"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Subproject Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Usage"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Projects defining entities"),(0,r.kt)("td",{parentName:"tr",align:null},"Generate necessary code based on entity definitions, such as Draft, SQL DSL, Fetcher"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Projects defining DTO files under ",(0,r.kt)("inlineCode",{parentName:"td"},"src/main/dto")),(0,r.kt)("td",{parentName:"tr",align:null},"Generate DTO classes based on the DTO language code"),(0,r.kt)("td",{parentName:"tr",align:null},"For Java, unless the current subproject has entity definitions, you need to find any class and annotate it with ",(0,r.kt)("inlineCode",{parentName:"td"},"@EnableDtoGeneration"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Projects using Spring Web annotations"),(0,r.kt)("td",{parentName:"tr",align:null},"Automatically generate OpenAPI documentation and TypeScript code, writing Java/Kotlin documentation comments into the documentation and client code; support for remote exceptions"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("h2",{id:"notes"},"Notes"),(0,r.kt)("p",null,"Since Jimmer is a compile-time framework, and considering that not all users are familiar with ",(0,r.kt)("inlineCode",{parentName:"p"},"apt")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"ksp"),", it's necessary to mention an important detail. "),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Apt/Ksp")," are standard technologies in the industry, and Java IDEs provide support for them."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"In most cases, your modifications will include changes to Java or Kotlin code, such as changes in entity types or Web Controller",(0,r.kt)("em",{parentName:"p"},"(Jimmer has its own implementations for OpenAPI and TypeScript generation)"),". In this case, you only need to click the IDE's ",(0,r.kt)("inlineCode",{parentName:"p"},"Run")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"Debug")," button once, without requiring a full compilation, to trigger all pre-compilation behaviors, the automatically generated source code and resource files will update automatically.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"In rare cases, if you only modify DTO files, meaning there are no Java or Kotlin source code changes within the same project except for the DTO files, you have three options:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Use the companion DTO plugin"),(0,r.kt)("li",{parentName:"ul"},"Perform a full compilation using maven or gradle commands, or the IDE's ",(0,r.kt)("inlineCode",{parentName:"li"},"Rebuild")," button, which can achieve this purpose"),(0,r.kt)("li",{parentName:"ul"},"Delete the affected project's compilation output directory, then click the IDE's ",(0,r.kt)("inlineCode",{parentName:"li"},"Run")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"Debug")," button`")))),(0,r.kt)("h2",{id:"two-styles-of-java-code"},"Two Styles of Java Code"),(0,r.kt)("p",null,"Unlike the Kotlin API, the Java API cannot avoid to directly use automatically generate types in user code. Let's compare the following:"),(0,r.kt)("table",null,(0,r.kt)("thead",null,(0,r.kt)("th",null,"Feature"),(0,r.kt)("th",null,"Java"),(0,r.kt)("th",null,"Kotlin")),(0,r.kt)("tbody",null,(0,r.kt)("tr",null,(0,r.kt)("td",{rowspan:"2"},"Draft"),(0,r.kt)("td",null,"Use the generated type `BookDraft`"),(0,r.kt)("td",null,"Use the original entity type `Book`")),(0,r.kt)("tr",null,(0,r.kt)("td",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'Book book = \n    // highlight-next-line\n    BookDraft.$.produce(b -> {\n        b.setName("SQL");\n        b.addIntoAuthors(a -> {\n            a.setName("Jessica");\n        });\n        b.addIntoAuthors(a -> {\n            a.setName("Bob");\n        });\n    });\n'))),(0,r.kt)("td",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},'val book =\n    // highlight-next-line\n    Book {\n        name = "SQL in Action"\n        authors().addBy {\n            name = "Jessica"\n        }\n        authors().addBy {\n            name = "Bob"\n        }\n    }\n')))),(0,r.kt)("tr",null,(0,r.kt)("td",{rowspan:"2"},"SQL DSL"),(0,r.kt)("td",null,"Use the generated type `BookTable`"),(0,r.kt)("td",null,"Use the original entity type `Book`")),(0,r.kt)("tr",null,(0,r.kt)("td",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"// highlight-next-line\nBookTable table = BookTable.$;\n\nList<Book> books = sqlClient\n    .createQuery(table)\n    .where(table.storeId().isNull())\n    .orderBy(table.name())\n    .select(table)\n    .execute();\n"))),(0,r.kt)("td",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},"List<Book> books = sqlClient\n    // highlight-next-line\n    .createQuery(Book::class) {\n        where(table.storeId.isNull())\n        orderBy(table.name)\n        select(table)\n    }\n    .execute()\n")))),(0,r.kt)("tr",null,(0,r.kt)("td",{rowspan:"2"},"Fetcher"),(0,r.kt)("td",null,"Use the generated types `BookFetcher`, `BookStoreFetcher`, and `AuthorFetcher`"),(0,r.kt)("td",null,"Use the original entity type `Book`")),(0,r.kt)("tr",null,(0,r.kt)("td",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"Fetcher<Book> fetcher =\n    // highlight-next-line\n    BookFetcher.$\n        .allScalarFields()\n        .store(\n            // highlight-next-line\n            BookStoreFetcher.$\n                .allScalarFields()\n        )\n        .authors(\n            // highlight-next-line\n            AuthorFetcher.$\n                .allScalarFields()\n        )\n"))),(0,r.kt)("td",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},"val fetcher = \n    // highlight-next-line\n    newFetcher(Book::class).by {\n        allScalarFields()\n        store {\n            allScalarFields()\n        }\n        authors {\n            allScalarFields()\n        }\n    }\n")))))),(0,r.kt)("p",null,"As you can see, the abstraction capabilities of Java and Kotlin are different, resulting in different effects that the API design can achieve:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For Kotlin, regardless of the scenario, you only need to use the original entity type ",(0,r.kt)("inlineCode",{parentName:"p"},"Book"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For Java, you have to use the types automatically generated by the Annotation Processor, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"BookDraft"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"BookTable"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"BookFetcher"),", etc."),(0,r.kt)("p",{parentName:"li"},"In the above Java code, ",(0,r.kt)("inlineCode",{parentName:"p"},".$")," appears frequently, ",(0,r.kt)("inlineCode",{parentName:"p"},"$")," are static read-only fields of these classes."))),(0,r.kt)("p",null,"Actually, using ",(0,r.kt)("inlineCode",{parentName:"p"},"$")," is the simplest way. However, considering that some Java developers have subjective biases against ",(0,r.kt)("inlineCode",{parentName:"p"},"$"),", for Java subprojects defining entity types, Jimmer's APT also generate four summary types:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"Objects")," class")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"Tables")," interface")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"TableExes")," interface")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"Fetchers")," interface"))),(0,r.kt)("p",null,"The package where these four types reside is the common package for all entities."),(0,r.kt)("p",null,"These four types provide another coding style for Java code by defining static constants, and the two styles are compared as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Style Accepting ",(0,r.kt)("inlineCode",{parentName:"th"},"$")),(0,r.kt)("th",{parentName:"tr",align:null},"Style Not Accepting ",(0,r.kt)("inlineCode",{parentName:"th"},"$")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"BookDraft.$.produce"),(0,r.kt)("td",{parentName:"tr",align:null},"Immutables.createBook")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"BookTable.$"),(0,r.kt)("td",{parentName:"tr",align:null},"Tables.BOOK_TABLE")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"BookTableEx.$"),(0,r.kt)("td",{parentName:"tr",align:null},"TableExes.BOOK_TABLE_EX")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"BookFetcher.$"),(0,r.kt)("td",{parentName:"tr",align:null},"Fetchers.BOOK_FETCHER")))),(0,r.kt)("p",null,"Additionally, ",(0,r.kt)("inlineCode",{parentName:"p"},"Tables"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"TableExes"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"Fetchers")," are interfaces, and you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"implements")," statement to further simplify the code ",(0,r.kt)("em",{parentName:"p"},"(since IntelliJ does not support static imports well, implementing interfaces that define constants is still a recommended technique)"),". For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},"public interface FetcherConstants\n// highlight-next-line\nimplements Fetchers {\n    \n    Fetcher<Book> BOOK_DETAIL_FETCHER =\n        BOOK_FETCHER\n            .allScalarFields()\n            .store(\n                BOOK_STORE_FETCHER\n                    .allScalarFields()\n            )\n            .authors {\n                AUTHOR_FETCHER\n                    .allScalarFields()\n            };\n}\n")),(0,r.kt)("h2",{id:"integration-with-lombok"},"Integration with Lombok"),(0,r.kt)("p",null,"Java projects often use Lombok."),(0,r.kt)("p",null,"By default, if the project does not have any APT other than Lombok, you only need to import the Lombok dependency."),(0,r.kt)("p",null,"However, once you introduce other APT configurations ",(0,r.kt)("em",{parentName:"p"},"(not necessarily Jimmer's APT, but any other APT)"),", you must explicitly configure Lombok's APT."),(0,r.kt)(o.Z,{groupId:"buildTool",mdxType:"Tabs"},(0,r.kt)(l.Z,{value:"java_maven",label:"Java(Maven)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="pom.xml"',title:'"pom.xml"'},"...omitted other code...\n\n<build>\n    <plugins>\n        <plugin>\n            <groupId>org.apache.maven.plugins</groupId>\n            <artifactId>maven-compiler-plugin</artifactId>\n            <version>3.10.1</version>\n            <configuration>\n                <annotationProcessorPaths>\n                    \x3c!--highlight-start--\x3e\n                    <path>\n                        <groupId>org.projectlombok</groupId>\n                        <artifactId>lombok</artifactId>\n                        <version>${lombok.version}</version>\n                    </path>\n                    \x3c!--highlight-end--\x3e\n                    <path>\n                        <groupId>org.babyfish.jimmer</groupId>\n                        <artifactId>jimmer-apt</artifactId>\n                        <version>${jimmer.version}</version>\n                    </path>\n                </annotationProcessorPaths>\n            </configuration>\n        </plugin>\n    </plugins>\n</build>\n\n...omitted other code...\n"))),(0,r.kt)(l.Z,{value:"java_gradle",label:"Java(Gradle)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-groovy",metastring:'title="build.gradle"',title:'"build.gradle"'},'dependencies {\n    \n    ...omitted other dependencies...\n\n    // highlight-next-line\n    annotationProcessor "org.projectlombok:lombok:${lombokVersion}"\n    annotationProcessor "org.babyfish.jimmer:jimmer-apt:${jimmerVersion}"\n}\n'))),(0,r.kt)(l.Z,{value:"java_gradle_plugin",label:"Java(Gradle Plugin)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-groovy",metastring:'title="build.gradle"',title:'"build.gradle"'},'plugins {\n    id "tech.argonariod.gradle-plugin-jimmer" version "latest.release"\n\n    ...\u7701\u7565\u5176\u5b83\u63d2\u4ef6...\n}\n\njimmer {\n    version = ...\n}\n\ndependencies {\n        \n    ...omitted other dependencies...\n\n    // highlight-next-line\n    annotationProcessor "org.projectlombok:lombok:${lombokVersion}"\n}\n')))))}h.isMDXComponent=!0}}]);