"use strict";(self.webpackChunkdocusaurus_code=self.webpackChunkdocusaurus_code||[]).push([[5796],{88336:(e,n,i)=>{i.d(n,{Ay:()=>r,RM:()=>o});var s=i(74848),t=i(28453);i(11470),i(19365);const o=[];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",li:"li",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"There are 5 modes for child object dissociation operations"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Mode"}),(0,s.jsx)("th",{children:"Description"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsxs)(n.p,{children:["NONE ",(0,s.jsx)(n.em,{children:"(Default)"})]})}),(0,s.jsxs)("td",{children:[(0,s.jsxs)(n.p,{children:["Depends on global configuration ",(0,s.jsx)(n.a,{href:"/docs/configuration/dissociate-action-checking",children:"jimmer.default-dissociate-action-checking"})]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.a,{href:"/docs/configuration/dissociate-action-checking",children:"jimmer.default-dissociate-action-checking"})," is true ",(0,s.jsx)(n.em,{children:"(default)"})," or the foreign key upon which the current association is based is real ",(0,s.jsxs)(n.em,{children:["(foreign key constraint exists in database, see ",(0,s.jsx)(n.a,{href:"/docs/mapping/base/foreignkey",children:"Real and Fake Foreign Keys"}),")"]}),", treated as ",(0,s.jsx)(n.code,{children:"CHECK"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.a,{href:"/docs/configuration/dissociate-action-checking",children:"jimmer.default-dissociate-action-checking"})," is false and the foreign key upon which the current association is based is fake ",(0,s.jsxs)(n.em,{children:["(no corresponding foreign key constraint in database, see ",(0,s.jsx)(n.a,{href:"/docs/mapping/base/foreignkey",children:"Real and Fake Foreign Keys"}),")"]}),", treated as ",(0,s.jsx)(n.code,{children:"LAX"}),"."]}),"\n"]}),"\n"]})]})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"LAX"}),(0,s.jsxs)("td",{children:[(0,s.jsx)(n.p,{children:"Dissociation operation performs no action."}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the foreign key is real ",(0,s.jsxs)(n.em,{children:["(see ",(0,s.jsx)(n.a,{href:"/docs/mapping/base/foreignkey",children:"Real and Fake Foreign Keys"}),")"]}),", when parent object is deleted:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If cascade delete behavior is configured for the database foreign key (",(0,s.jsx)(n.code,{children:"on cascade set null"})," or ",(0,s.jsx)(n.code,{children:"on delete delete"}),"), database automatically clears the foreign key of dissociated child objects or automatically deletes the dissociated child objects"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Although database-level cascade modification performs better than ORM-level cascade modification, the ORM is unaware of this. Use with caution in projects requiring cache consistency"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Otherwise, database reports an error and the save command is terminated"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the foreign key is fake ",(0,s.jsxs)(n.em,{children:["(see ",(0,s.jsx)(n.a,{href:"/docs/mapping/base/foreignkey",children:"Real and Fake Foreign Keys"}),")"]}),", when parent object is deleted, no additional behavior occurs, allowing dangling issues with child object foreign key values"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Even if fake foreign key values are invalid dangling values, jimmer queries won't error - the query system will return null for parent objects rather than error due to non-existent parent"}),"\n"]}),"\n"]}),"\n"]})]})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"CHECK"}),(0,s.jsx)("td",{children:"Does not support dissociation operations. Throws exception to prevent operation if current parent object in database has child objects that need to be dissociated."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"SET_NULL"}),(0,s.jsx)("td",{children:"Sets the foreign key of dissociated child objects to null. This mode requires that the child object's foreign key property is nullable; otherwise attempting this configuration will cause an exception."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"DELETE"}),(0,s.jsx)("td",{children:"Deletes the dissociated child objects."})]})]})]})]})}function r(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},22348:(e,n,i)=>{i.d(n,{Ay:()=>r,RM:()=>o});var s=i(74848),t=i(28453);const o=[];function a(e){const n={code:"code",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Existing Database Structure"}),(0,s.jsx)("th",{children:"User's Expected Data Structure"})]})}),(0,s.jsx)("tbody",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"+-Food\n|\n|\n|\n# highlight-next-line\n+-----Meat(ignore child nodes)\n|\n\\-----Bread(ignore child nodes)\n"})})}),(0,s.jsx)("td",{children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"+-Food\n|\n+-----Drinks(ignore child nodes)\n|\n|\n|\n\\-----Bread(ignore child nodes)\n"})})})]})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"Bread"}),", it exists in both old and new data structures, corresponding to an UPDATE operation"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"Drinks"}),", it doesn't exist in the old data structure but exists in the new data, corresponding to an INSERT operation"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["For ",(0,s.jsx)(n.code,{children:"Meat"}),", it exists in the old data structure but not in the new data, corresponding to an operation called dissociation operation."]}),"\n"]}),"\n"]})]})}function r(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},76924:(e,n,i)=>{i.d(n,{Ay:()=>l,RM:()=>r});var s=i(74848),t=i(28453),o=i(11470),a=i(19365);const r=[];function c(e){const n={a:"a",admonition:"admonition",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Saving the root object is not the focus of this article, collapsed by default"}),(0,s.jsxs)(o.A,{groupId:"database",children:[(0,s.jsx)(a.A,{value:"h2",label:"H2",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"merge into BOOK_STORE(\n    NAME\n) key(NAME) values(\n    ?\n)\n/* batch-0: [MANNING] */\n/* batch-1: [AMAZON] */\n"})})}),(0,s.jsxs)(a.A,{value:"mysql",label:"Mysql",children:[(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMySQL\u7684\u6279\u91cf\u64cd\u4f5c\u4e0d\u4f1a\u88ab\u91c7\u7528\uff0c\u800c\u91c7\u7528\u591a\u6761SQL\u3002\u5177\u4f53\u7ec6\u8282\u8bf7\u53c2\u8003",(0,s.jsx)(n.a,{href:"../mysql",children:"MySQL\u7684\u95ee\u9898"})]})}),(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"insert into BOOK_STORE(\n    NAME\n) values(\n    ? /* MANNING */\n) on duplicate key update\n    /* fake update to return all ids */ ID = last_insert_id(ID)\n\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"insert into BOOK_STORE(\n    NAME\n) values(\n    ? /* AMAZON */\n) on duplicate key update\n    /* fake update to return all ids */ ID = last_insert_id(ID)\n"})}),"\n"]}),"\n"]})]}),(0,s.jsx)(a.A,{value:"postgres",label:"Postgres",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"insert into BOOK_STORE(\n    NAME\n) values(\n    ?\n) on conflict(\n    NAME\n) do update set\n    /* fake update to return all ids */ NAME = execluded.NAME\nreturning ID\n/* batch-0: [MANNING] */\n/* batch-1: [AMAZON] */\n"})})})]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Assume ",(0,s.jsx)(n.code,{children:"MANNING"})," exists with an id of ",(0,s.jsx)(n.code,{children:"2"})]}),"\n",(0,s.jsxs)(n.li,{children:["Assume ",(0,s.jsx)(n.code,{children:"AMAZON"})," exists, after insertion, the database automatically assigns a new id of ",(0,s.jsx)(n.code,{children:"100"})]}),"\n"]})]})}function l(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},47729:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>m,contentTitle:()=>p,default:()=>b,frontMatter:()=>j,metadata:()=>s,toc:()=>g});const s=JSON.parse('{"id":"mutation/save-command/association/dissociation","title":"Dissociation Operations","description":"When saving associated objects using the association mode AssociatedSaveMode.REPLACE,","source":"@site/docs/mutation/save-command/association/dissociation.mdx","sourceDirName":"mutation/save-command/association","slug":"/mutation/save-command/association/dissociation","permalink":"/jimmer-doc/docs/mutation/save-command/association/dissociation","draft":false,"unlisted":false,"editUrl":"https://github.com/babyfish-ct/jimmer-doc/edit/main/docs/mutation/save-command/association/dissociation.mdx","tags":[],"version":"current","lastUpdatedAt":1741228772000,"sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Dissociation Operations"},"sidebar":"tutorialSidebar","previous":{"title":"Associated Save Mode","permalink":"/jimmer-doc/docs/mutation/save-command/association/associated-save-mode"},"next":{"title":"Constraint Violation Error Handling","permalink":"/jimmer-doc/docs/mutation/save-command/investigation"}}');var t=i(74848),o=i(28453),a=i(11470),r=i(19365),c=(i(64087),i(46845),i(74400),i(88336)),l=i(22348),d=i(76924);const h=[];function u(e){const n={a:"a",admonition:"admonition",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:"Saving associations and associated objects is also not the focus of this article, collapsed by default"}),(0,t.jsxs)(a.A,{groupId:"database",children:[(0,t.jsx)(r.A,{value:"h2",label:"H2",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"merge into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) key(\n    NAME, EDITION\n) values(\n    ?, ?, ?, ?\n)\n/* batch-0: [Learning GraphQL, 3, 51.9, 1] */\n/* batch-1: [Learning GraphQL, 4, 43.9, 1] */\n/* batch-2: [Effective TypeScript, 3, 88.9, 1] */\n/* batch-3: [Effective TypeScript, 4, 85.9, 1] */\n/* batch-4: [Programming TypeScript, 3, 48.9, 1] */\n/* batch-5: [Programming TypeScript, 4, 47.9, 1] */\n/* batch-6: [GraphQL in Action, 3, 80.9, 2] */\n/* batch-7: [GraphQL in Action, 4, 81.9, 2] */\n"})})}),(0,t.jsxs)(r.A,{value:"mysql",label:"Mysql",children:[(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:["By default, MySQL batch operations are not used.\nFor specific details, please refer to ",(0,t.jsx)(n.a,{href:"../mysql",children:"MySQL Issues"})]})}),(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* Learning GraphQL */, \n    ? /* 3 */, \n    ? /* 51.9 */, \n    ? /* 1 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* Learning GraphQL */, \n    ? /* 4 */, \n    ? /* 43.9 */, \n    ? /* 1 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* Effective TypeScript */, \n    ? /* 3 */, \n    ? /* 88.9 */, \n    ? /* 1 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* Effective TypeScript */, \n    ? /* 4 */, \n    ? /* 85.9 */, \n    ? /* 1 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* Programming TypeScript */, \n    ? /* 3 */, \n    ? /* 48.9 */, \n    ? /* 1 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* Programming TypeScript */, \n    ? /* 4 */, \n    ? /* 47.9 */, \n    ? /* 1 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* GraphQL in Action */, \n    ? /* 3 */, \n    ? /* 80.9 */, \n    ? /* 2 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ? /* GraphQL in Action */, \n    ? /* 4 */, \n    ? /* 81.9 */, \n    ? /* 2 */\n) on duplicate key udpate\n    /* fake update to return all ids */ ID = last_insert_id(ID),\n    PRICE = values(PRICE),\n    STORE_ID = values(STORE_ID)\n"})}),"\n"]}),"\n"]})]}),(0,t.jsx)(r.A,{value:"postgres",label:"Postgres",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"insert into BOOK(\n    NAME, EDITION, PRICE, STORE_ID\n) values(\n    ?, ?, ?, ?\n) on conflict(\n    NAME, EDITION\n) do update set\n    PRICE = excluded.PRICE,\n    STORE_ID = excluded.STORE_ID\nreturning ID\n/* batch-0: [Learning GraphQL, 3, 51.9, 1] */\n/* batch-1: [Learning GraphQL, 4, 43.9, 1] */\n/* batch-2: [Effective TypeScript, 3, 88.9, 1] */\n/* batch-3: [Effective TypeScript, 4, 85.9, 1] */\n/* batch-4: [Programming TypeScript, 3, 48.9, 1] */\n/* batch-5: [Programming TypeScript, 4, 47.9, 1] */\n/* batch-6: [GraphQL in Action, 3, 80.9, 2] */\n/* batch-7: [GraphQL in Action, 4, 81.9, 2] */\n"})})})]})]})}function x(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}const j={sidebar_position:7,title:"Dissociation Operations"},p=void 0,m={},g=[{value:"Concept",id:"concept",level:2},...l.RM,{value:"Dissociating Middle Table Associations",id:"dissociating-middle-table-associations",level:2},{value:"Dissociating Child Table Associations",id:"dissociating-child-table-associations",level:2},{value:"Dissociation Modes",id:"dissociation-modes",level:3},...c.RM,{value:"Save Code",id:"save-code",level:3},{value:"1. NONE <em>(Default)</em>",id:"1-none-default",level:3},{value:"2. LAX",id:"2-lax",level:3},{value:"3. CHECK",id:"3-check",level:3},...d.RM,...h,{value:"4. SET_NULL",id:"4-set_null",level:3},...d.RM,...h,{value:"5. DELETE",id:"5-delete",level:3},...d.RM,...h];function f(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["When saving associated objects using the association mode ",(0,t.jsx)(n.code,{children:"AssociatedSaveMode.REPLACE"}),",\nthere is an important concept: dissociation operation."]}),"\n",(0,t.jsx)(n.h2,{id:"concept",children:"Concept"}),"\n",(0,t.jsx)(l.Ay,{}),"\n",(0,t.jsx)(n.p,{children:"Dissociation applies to two types of associations:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Middle table associations"}),"\n",(0,t.jsxs)(n.p,{children:["Obviously, middle table associations refer to associations like ",(0,t.jsx)(n.code,{children:"Book.authors"})," and ",(0,t.jsx)(n.code,{children:"Author.books"})," in this tutorial."]}),"\n",(0,t.jsx)(n.p,{children:"Their dissociation operation is very simple, just deleting the association in the middle table, without affecting the associated objects themselves."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Child table associations"}),"\n",(0,t.jsxs)(n.p,{children:["Child table associations refer to inverse associations based on foreign keys ",(0,t.jsx)(n.em,{children:"(whether real or fake)"}),", such as ",(0,t.jsx)(n.code,{children:"BookStore.books"})," in this tutorial."]}),"\n",(0,t.jsx)(n.p,{children:"Their dissociation operation is relatively complex. Developers can control specific dissociation behavior through configuration."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Next, let's discuss these two types of dissociation operations."}),"\n",(0,t.jsx)(n.h2,{id:"dissociating-middle-table-associations",children:"Dissociating Middle Table Associations"}),"\n",(0,t.jsxs)(n.p,{children:["We've already demonstrated this simplest form of dissociation when introducing the ",(0,t.jsx)(n.a,{href:"./associated-save-mode#5-replace",children:"REPLACE"})," save mode for associated objects."]}),"\n",(0,t.jsx)(n.p,{children:"Therefore, we won't repeat it here."}),"\n",(0,t.jsx)(n.h2,{id:"dissociating-child-table-associations",children:"Dissociating Child Table Associations"}),"\n",(0,t.jsxs)(n.p,{children:["Child table associations refer to inverse associations based on foreign keys ",(0,t.jsx)(n.em,{children:"(whether real or fake)"}),", such as ",(0,t.jsx)(n.code,{children:"BookStore.books"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Their dissociation operation is relatively complex. Developers can configure the dissociation mode for properties corresponding to foreign keys ",(0,t.jsxs)(n.em,{children:["(such as ",(0,t.jsx)(n.code,{children:"Book.store"})," here)"]})," to achieve different dissociation behaviors."]}),"\n",(0,t.jsx)(n.h3,{id:"dissociation-modes",children:"Dissociation Modes"}),"\n",(0,t.jsx)(c.Ay,{}),"\n",(0,t.jsx)(n.p,{children:"There are two ways to configure dissociation mode:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Static configuration using annotations on entities, which is global."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Dynamic configuration in code, which can override static configuration but only affects the current save command."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Taking ",(0,t.jsx)(n.code,{children:"SET_NULL"})," as an example:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Static entity-based configuration ",(0,t.jsx)(n.em,{children:"(chosen in most cases, used by the majority of business logic)"})]}),"\n",(0,t.jsxs)(a.A,{groupId:"language",children:[(0,t.jsx)(r.A,{value:"java",label:"Java",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Book.java"',children:"@Entity\npublic interface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.SET_NULL)\n    @Nullable\n    @ManyToOne\n    BookStore store();\n\n    ...omitted other code...\n}\n"})})}),(0,t.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-kotlin",metastring:'title="Book.kt"',children:"@Entity\ninterface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.SET_NULL)\n    @ManyToOne\n    val store: BookStore?\n\n    ...omitted other code...        \n}\n"})})})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Dynamic save command-based configuration ",(0,t.jsx)(n.em,{children:"(only for individual save commands, used by very few businesses with special requirements)"})]}),"\n",(0,t.jsxs)(a.A,{groupId:"language",children:[(0,t.jsx)(r.A,{value:"java",label:"Java",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"sqlClient\n    .getEntities()\n    .saveCommand(book)\n    // highlight-next-line\n    .setDissociateAction(\n        BookProps.STORE, \n        DissociateAction.SET_NULL\n    )\n    .execute();\n"})})}),(0,t.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-kotlin",children:"sqlClient.save(book) {\n    // highlight-next-line\n    setDissociateAction(\n        Book::store, \n        DissociateAction.SET_NULL\n    )\n}\n"})})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"save-code",children:"Save Code"}),"\n",(0,t.jsxs)(n.p,{children:["Next, let's explain various dissociation modes through saving data structures containing one-to-many association ",(0,t.jsx)(n.code,{children:"BookStore.books"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Here's the save code:"}),"\n",(0,t.jsxs)(a.A,{groupId:"language",children:[(0,t.jsx)(r.A,{value:"java",label:"Java",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'List<BookStore> stores = Arrays.asList(\n    Immutables.createBookStore(draft -> {\n        draft.setName("O\'REILLY");\n        draft.addIntoBooks(book -> {\n            book.setName("Learning GraphQL");\n            book.setEdition(3);\n            book.setPrice(new BigDecimal("51.9"));\n        });\n        draft.addIntoBooks(book -> {\n            book.setName("Learning GraphQL");\n            book.setEdition(4);\n            book.setPrice(new BigDecimal("43.9"));\n        });\n        draft.addIntoBooks(book -> {\n            book.setName("Effective TypeScript");\n            book.setEdition(3);\n            book.setPrice(new BigDecimal("88.9"));\n        });\n        draft.addIntoBooks(book -> {\n            book.setName("Effective TypeScript");\n            book.setEdition(4);\n            book.setPrice(new BigDecimal("85.9"));\n        });\n        draft.addIntoBooks(book -> {\n            book.setName("Programming TypeScript");\n            book.setEdition(3);\n            book.setPrice(new BigDecimal("48.9"));\n        });\n        draft.addIntoBooks(book -> {\n            book.setName("Programming TypeScript");\n            book.setEdition(4);\n            book.setPrice(new BigDecimal("47.9"));\n        });\n    }),\n    Immutables.createBookStore(draft -> {\n        draft.setName("MANNING");\n        draft.addIntoBooks(book -> {\n            book.setName("GraphQL in Action");\n            book.setEdition(3);\n            book.setPrice(new BigDecimal("80.9"));\n        });\n        draft.addIntoBooks(book -> {\n            book.setName("GraphQL in Action");\n            book.setEdition(4);\n            book.setPrice(new BigDecimal("81.9"));\n        });\n    })\n);\nsqlClient.saveEntities(\n    stores,\n    // This parameter can be omitted, for the `save` method,\n    // AssociatedSaveMode defaults to REPLACE\n    AssociatedSaveMode.REPLACE\n);\n'})})}),(0,t.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-kotlin",children:'val stores = listOf(\n    BookStore {\n        name = "O\'REILLY"\n        books().addBy {\n            name = "Learning GraphQL"\n            edition = 3\n            price = BigDecimal("51.9")\n        }\n        books().addBy {\n            name = "Learning GraphQL"\n            edition = 4\n            price = BigDecimal("32.9")\n        }\n        books().addBy {\n            name = "Effective TypeScript"\n            edition = 3\n            price = BigDecimal("88.9")\n        }\n        books().addBy {\n            name = "Effective TypeScript"\n            edition = 4\n            price = BigDecimal("85.9")\n        }\n        books().addBy {\n            name = "Programming TypeScript"\n            edition = 3\n            price = BigDecimal("48.9")\n        }\n        books().addBy {\n            name = "Programming TypeScript"\n            edition = 4\n            price = BigDecimal("47.9")\n        }\n    },\n    BookStore {\n        name = "MANNING"\n        books().addBy {\n            name = "GraphQL in Action"\n            edition = 3\n            price = BigDecimal("80.9")\n        }\n        books().addBy {\n            name = "GraphQL in Action"\n            edition = 4\n            price = BigDecimal("81.9")\n        }\n    }\n)\nsqlClient.saveEntities(\n    stores,\n    // This parameter can be omitted, for the `save` method,\n    // AssociatedSaveMode defaults to REPLACE\n    AssociatedSaveMode.REPLACE\n)\n'})})})]}),"\n",(0,t.jsx)(n.p,{children:"Comparison between old and new objects:"}),"\n",(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Existing Database Data"}),(0,t.jsx)("th",{children:"Data User Wants to Save"})]})}),(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"--+-O'REILLY\n  |\n  # highlight-next-line\n  +---Learn GraphQL(edition = 1)\n  |\n  # highlight-next-line\n  +---Learn GraphQL(edition = 2)\n  |\n  +---Learn GraphQL(edition = 3)\n  |\n  |\n  |\n  # highlight-next-line\n  +---Effective TypeScript(edition = 1)\n  |\n  # highlight-next-line\n  +---Effective TypeScript(edition = 2)\n  |\n  +---Effective TypeScript(edition = 3)\n  |\n  |\n  |\n  # highlight-next-line\n  +---Programming TypeScript(edition = 1)\n  |\n  # highlight-next-line\n  +---Programming TypeScript(edition = 2)\n  |\n  \\---Programming TypeScript(edition = 3)\n\n\n"})})}),(0,t.jsx)("td",{children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"--+-O'REILLY\n  |\n  |\n  |\n  |\n  |\n  +---Learn GraphQL(edition = 3)\n  |\n  +---Learn GraphQL(edition = 4)\n  |\n  |\n  |\n  |\n  |\n  +---Effective TypeScript(edition = 3)\n  |\n  +---Effective TypeScript(edition = 4)\n  |\n  |\n  |\n  |\n  |\n  +---Programming TypeScript(edition = 3)\n  |\n  \\---Programming TypeScript(edition = 4)\n"})})})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"--+-MANNING\n  |\n  # highlight-next-line\n  +---GraphQL in Action(edition = 1)\n  |\n  # highlight-next-line\n  +---GraphQL in Action(edition = 2)\n  |\n  \\---GraphQL in Action(edition = 3)\n  \n\n"})})}),(0,t.jsx)("td",{children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"--+-MANNING\n  |\n  |\n  |\n  |\n  |\n  +---GraphQL in Action(edition = 3)\n  |\n  \\---GraphQL in Action(edition = 4)\n"})})})]})]})]}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.p,{children:"Among them, the 8 associated objects that are no longer needed, i.e., the 8 objects that need to be dissociated, are highlighted."}),(0,t.jsx)(n.p,{children:"So, how will Jimmer dissociate these associated objects?"}),(0,t.jsx)(n.p,{children:"In fact, different dissociation configurations will lead to different dissociation behaviors."})]}),"\n",(0,t.jsxs)(n.h3,{id:"1-none-default",children:["1. NONE ",(0,t.jsx)(n.em,{children:"(Default)"})]}),"\n",(0,t.jsxs)(n.p,{children:["NONE's behavior is not fixed, but depends on the global configuration ",(0,t.jsx)(n.code,{children:"jimmer.default-dissociate-action-check"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"jimmer.default-dissociate-action-check"})," is true ",(0,t.jsx)(n.em,{children:"(default)"})," or if the current association is based on a real foreign key ",(0,t.jsxs)(n.em,{children:["(foreign key constraint exists in database, see ",(0,t.jsx)(n.a,{href:"../../../mapping/base/foreignkey",children:"Real vs Fake Foreign Keys"}),")"]}),", treated as ",(0,t.jsx)(n.a,{href:"#3-check",children:"CHECK"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"jimmer.default-dissociate-action-check"})," is false and the current association is based on a fake foreign key (no corresponding foreign key constraint in database, see ",(0,t.jsx)(n.a,{href:"../../../mapping/base/foreignkey",children:"Real vs Fake Foreign Keys"}),"), treated as ",(0,t.jsx)(n.a,{href:"#2-lax",children:"LAX"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-lax",children:"2. LAX"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Dissociate mode ",(0,t.jsx)(n.code,{children:"LAX"})," means the dissociation operation does nothing."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Associated save mode ",(0,t.jsx)(n.code,{children:"AssociatedSaveMode.REPLACE"})," means unnecessary associations need to be discarded."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Clearly, these two rules conflict. In this case, ",(0,t.jsx)(n.code,{children:"AssociatedSaveMode.REPLACE"})," takes precedence, ",(0,t.jsx)(n.code,{children:"LAX"})," is ignored, and it's ultimately treated as ",(0,t.jsx)(n.a,{href:"#3-check",children:"CHECK"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Therefore, we cannot demonstrate ",(0,t.jsx)(n.code,{children:"LAX"})," through this article. To understand how ",(0,t.jsx)(n.code,{children:"LAX"})," works, please see ",(0,t.jsx)(n.a,{href:"../../delete-command",children:"Delete Command"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"3-check",children:"3. CHECK"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CHECK"})," mode does not allow dissociating associated objects. Jimmer will check if there are objects that need to be dissociated, and if they exist, throws an exception."]}),"\n",(0,t.jsx)(n.p,{children:"The dissociate mode can be set either through the entity definition or through the save command."}),"\n",(0,t.jsxs)(n.p,{children:["Here, we set the dissociate mode for ",(0,t.jsx)(n.code,{children:"Book.store"})," through entity configuration:"]}),"\n",(0,t.jsxs)(a.A,{groupId:"language",children:[(0,t.jsx)(r.A,{value:"java",label:"Java",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Book.java"',children:"@Entity\n@KeyUniqueConstraint(noMoreUniqueConstraints = true)\npublic interface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.CHECK)\n    @Nullable\n    @ManyToOne\n    BookStore store();\n\n    ...omitted other code...\n}\n"})})}),(0,t.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-kotlin",metastring:'title="Book.kt"',children:"@Entity\n@KeyUniqueConstraint(noMoreUniqueConstraints = true)\ninterface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.CHECK)\n    @ManyToOne\n    val store: BookStore?\n\n    ...omitted other code...        \n}\n"})})})]}),"\n",(0,t.jsxs)(n.p,{children:["To demonstrate simpler SQL generation, let's assume ",(0,t.jsx)(n.code,{children:"sqlClient"}),"'s ",(0,t.jsx)(n.code,{children:"targetTransferable"})," feature is enabled, which was previously discussed, see ",(0,t.jsx)(n.a,{href:"./owner#2-configuring-whether-different-parent-objects-can-snatch-for-child-objects",children:"here"})]}),"\n",(0,t.jsx)(n.p,{children:"Running the save code from before will generate three SQL statements:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(d.Ay,{}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(x,{}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Check if there are objects that need to be dissociated ",(0,t.jsx)(n.em,{children:"(if any exist, throws exception to prevent save command)"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"select\n    tb_1_.ID\nfrom BOOK tb_1_\nwhere\n    tb_1_.STORE_ID in (\n        ? /* 1 */, ? /* 2 */\n    )\nand\n    (tb_1_.STORE_ID, tb_1_.ID) not in (\n        (? /* 1 */, ? /* 3 */), \n        (? /* 1 */, ? /* 100 */), \n        (? /* 1 */, ? /* 6 */), \n        (? /* 1 */, ? /* 101 */), \n        (? /* 1 */, ? /* 9 */), \n        (? /* 1 */, ? /* 102 */), \n        (? /* 2 */, ? /* 12 */), \n        (? /* 2 */, ? /* 103 */)\n    )\nlimit ? /* 1 */\n"})}),"\n",(0,t.jsxs)(n.p,{children:["After this SQL check, some ",(0,t.jsx)(n.code,{children:"Book"})," objects that will be dissociated are found through the saved ",(0,t.jsx)(n.code,{children:"BookStore"})," objects' ",(0,t.jsx)(n.code,{children:"Book.authors"})," property. However, they do not agree to be dissociated and throw the following exception:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'Save error caused by the path: "<root>.books": \n#highlight-next-line\nCannot dissociate child objects \nbecause the \ndissociation action of the many-to-one property \n"com.yourcommany.yourproject.model.Book.store" \nis not configured as "set null" or "cascade". \nThere are two ways to resolve this issue: \nDecorate the many-to-one property \n"com.yourcommany.yourproject.model.Bookstore" by \n@org.babyfish.jimmer.sql.OnDissociate whose argument \nis `DissociateAction.SET_NULL` or `DissociateAction.DELETE`, \nor use save command\'s runtime configuration to override it\n'})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"4-set_null",children:"4. SET_NULL"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"SET_NULL"})," mode achieves dissociation by setting the associated object's foreign key property to null."]}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"SET_NULL"})," mode requires that the foreign key-based property ",(0,t.jsxs)(n.em,{children:["(here ",(0,t.jsx)(n.code,{children:"Book.store"}),")"]})," must be nullable, otherwise it will cause a compilation error"]})}),"\n",(0,t.jsx)(n.p,{children:"The dissociate mode can be set either through the entity definition or through the save command."}),"\n",(0,t.jsxs)(n.p,{children:["Here, we set the dissociate mode for ",(0,t.jsx)(n.code,{children:"Book.store"})," through entity configuration:"]}),"\n",(0,t.jsxs)(a.A,{groupId:"language",children:[(0,t.jsx)(r.A,{value:"java",label:"Java",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Book.java"',children:"@Entity\n@KeyUniqueConstraint(noMoreUniqueConstraints = true)\npublic interface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.SET_NULL)\n    @Nullable\n    @ManyToOne\n    BookStore store();\n\n    ...omitted other code...\n}\n"})})}),(0,t.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-kotlin",metastring:'title="Book.kt"',children:"@Entity\n@KeyUniqueConstraint(noMoreUniqueConstraints = true)\ninterface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.SET_NULL)\n    @ManyToOne\n    val store: BookStore?\n\n    ...omitted other code...        \n}\n"})})})]}),"\n",(0,t.jsxs)(n.p,{children:["To demonstrate simpler SQL generation, let's assume ",(0,t.jsx)(n.code,{children:"sqlClient"}),"'s ",(0,t.jsx)(n.code,{children:"targetTransferable"})," feature is enabled, which was previously discussed, see ",(0,t.jsx)(n.a,{href:"./owner#2-configuring-whether-different-parent-objects-can-snatch-for-child-objects",children:"here"})]}),"\n",(0,t.jsx)(n.p,{children:"Running the save code from before will generate three SQL statements:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(d.Ay,{}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(x,{}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Set foreign keys to null for all objects being dissociated"}),"\n",(0,t.jsxs)(a.A,{groupId:"database",children:[(0,t.jsx)(r.A,{value:"h2",label:"H2",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"update BOOK\nset STORE_ID = null\nwhere\n    STORE_ID = ?\nand\n    not (\n        ID = any(?)\n    )\n/* batch-0: [1, [3, 100, 6, 101, 9, 102]] */\n/* batch-1: [2, [12, 103]] */\n"})})}),(0,t.jsx)(r.A,{value:"mysql",label:"MySQL",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"update BOOK\nset STORE_ID = null\nwhere\n    STORE_ID in (\n        ? /* 1 */, ? /* 2 */\n    )\nand\n    (STORE_ID, ID) not in (\n        (? /* 1 */, ? /* 3 */), \n        (? /* 1 */, ? /* 100 */), \n        (? /* 1 */, ? /* 6 */), \n        (? /* 1 */, ? /* 101 */), \n        (? /* 1 */, ? /* 9 */), \n        (? /* 1 */, ? /* 102 */), \n        (? /* 2 */, ? /* 12 */), \n        (? /* 2 */, ? /* 103 */)\n    )\n"})})}),(0,t.jsx)(r.A,{value:"postgres",label:"Postgres",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"update BOOK\nset STORE_ID = null\nwhere\n    STORE_ID = ?\nand\n    not (\n        ID = any(?)\n    )\n/* batch-0: [1, [3, 100, 6, 101, 9, 102]] */\n/* batch-1: [2, [12, 103]] */\n"})})})]}),"\n",(0,t.jsx)(n.p,{children:"We can see significant differences between databases:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"H2"})," and ",(0,t.jsx)(n.code,{children:"Postgres"})," use batched simple SQL"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"MySQL"})," uses a single complex SQL"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["This is because ",(0,t.jsx)(n.code,{children:"H2"})," and ",(0,t.jsx)(n.code,{children:"Postgres"})," support the ",(0,t.jsx)(n.code,{children:"=any(array)"})," syntax, while MySQL does not."]})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"5-delete",children:"5. DELETE"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"DELETE"})," mode achieves dissociation by deleting the associated objects."]}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsxs)(n.p,{children:["Here when saving ",(0,t.jsx)(n.code,{children:"BookStore"}),", we perform dissociation on the ",(0,t.jsx)(n.code,{children:"BookStore.books"})," association, where ",(0,t.jsx)(n.code,{children:"DELETE"})," mode indicates we want to delete unnecessary ",(0,t.jsx)(n.code,{children:"Book"})," objects."]}),(0,t.jsxs)(n.p,{children:["However, since the ",(0,t.jsx)(n.code,{children:"Book"})," entity has a deeper association ",(0,t.jsx)(n.code,{children:"Book.authors"}),", we need to consider how to dissociate ",(0,t.jsx)(n.code,{children:"Author"})," objects before deleting ",(0,t.jsx)(n.code,{children:"Book"})," objects."]}),(0,t.jsxs)(n.p,{children:["In fact, if objects that need to be deleted due to dissociation have deeper associations, it evolves into a recursive deletion problem.\nThis behavior is detailed in ",(0,t.jsx)(n.a,{href:"../../delete-command",children:"Delete Command"}),", which we won't discuss here."]}),(0,t.jsxs)(n.p,{children:["Therefore, to simplify the discussion, we'll temporarily ignore the ",(0,t.jsx)(n.code,{children:"Author"})," entity and assume the current system only has ",(0,t.jsx)(n.code,{children:"BookStore"})," and ",(0,t.jsx)(n.code,{children:"Book"})," entity types."]})]}),"\n",(0,t.jsx)(n.p,{children:"The dissociate mode can be set either through the entity definition or through the save command."}),"\n",(0,t.jsxs)(n.p,{children:["Here, we set the dissociate mode for ",(0,t.jsx)(n.code,{children:"Book.store"})," through entity configuration:"]}),"\n",(0,t.jsxs)(a.A,{groupId:"language",children:[(0,t.jsx)(r.A,{value:"java",label:"Java",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",metastring:'title="Book.java"',children:"@Entity\n@KeyUniqueConstraint(noMoreUniqueConstraints = true)\npublic interface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.DELETE)\n    @Nullable\n    @ManyToOne\n    BookStore store();\n\n    ...omitted other code...\n}\n"})})}),(0,t.jsx)(r.A,{value:"kotlin",label:"Kotlin",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-kotlin",metastring:'title="Book.kt"',children:"@Entity\n@KeyUniqueConstraint(noMoreUniqueConstraints = true)\ninterface Book {\n\n    //highlight-next-line\n    @OnDissociate(DissociateAction.DELETE)\n    @ManyToOne\n    val store: BookStore?\n\n    ...omitted other code...        \n}\n"})})})]}),"\n",(0,t.jsxs)(n.p,{children:["To demonstrate simpler SQL generation, let's assume ",(0,t.jsx)(n.code,{children:"sqlClient"}),"'s ",(0,t.jsx)(n.code,{children:"targetTransferable"})," feature is enabled, which was previously discussed, see ",(0,t.jsx)(n.a,{href:"./owner#2-configuring-whether-different-parent-objects-can-snatch-for-child-objects",children:"here"})]}),"\n",(0,t.jsx)(n.p,{children:"Running the save code from before will generate three SQL statements:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(d.Ay,{}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(x,{}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Delete all objects that need to be dissociated"}),"\n",(0,t.jsxs)(a.A,{groupId:"database",children:[(0,t.jsx)(r.A,{value:"h2",label:"H2",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"delete from BOOK\nwhere\n    STORE_ID = ?\nand\n    not (\n        ID = any(?)\n    )\n/* batch-0: [1, [3, 100, 6, 101, 9, 102]] */\n/* batch-1: [2, [12, 103]] */\n"})})}),(0,t.jsx)(r.A,{value:"mysql",label:"MySQL",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"delete from BOOK\nwhere\n    STORE_ID in (\n        ? /* 1 */, ? /* 2 */\n    )\nand\n    (STORE_ID, ID) not in (\n        (? /* 1 */, ? /* 3 */), \n        (? /* 1 */, ? /* 100 */), \n        (? /* 1 */, ? /* 6 */), \n        (? /* 1 */, ? /* 101 */), \n        (? /* 1 */, ? /* 9 */), \n        (? /* 1 */, ? /* 102 */), \n        (? /* 2 */, ? /* 12 */), \n        (? /* 2 */, ? /* 103 */)\n    )\n"})})}),(0,t.jsx)(r.A,{value:"postgres",label:"Postgres",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"delete from BOOK\nwhere\n    STORE_ID = ?\nand\n    not (\n        ID = any(?)\n    )\n/* batch-0: [1, [3, 100, 6, 101, 9, 102]] */\n/* batch-1: [2, [12, 103]] */\n"})})})]}),"\n",(0,t.jsx)(n.p,{children:"We can see significant differences between databases:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"H2"})," and ",(0,t.jsx)(n.code,{children:"Postgres"})," use batched simple SQL"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"MySQL"})," uses a single complex SQL"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["This is because ",(0,t.jsx)(n.code,{children:"H2"})," and ",(0,t.jsx)(n.code,{children:"Postgres"})," support the ",(0,t.jsx)(n.code,{children:"=any(array)"})," syntax, while MySQL does not."]})}),"\n"]}),"\n"]})]})}function b(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(f,{...e})}):f(e)}},46845:(e,n,i)=>{i.d(n,{Y:()=>C});var s=i(96540),t=i(67733),o=i(67512),a=i(43581),r=i(80421),c=i(1489),l=i(71543),d=i(57416),h=i(53881),u=i(88933),x=i(46780),j=i(19591),p=i(618),m=i(73231),g=i(30854),f=i(16718),b=i(4671),v=i(67034),y=i(63051),k=i(15993),A=i(28968),E=i(13407),I=i(46831),S=i(44586),D=i(82470),N=i(16712),T=i(74848);const C=(0,s.memo)((()=>{const{i18n:e}=(0,S.A)(),n=(0,N.o)(),i=(0,s.useMemo)((()=>n?L:O),[n]),C=(0,s.useMemo)((()=>{const e=new Map;for(const n of i)e.set(n.id,n);return e}),[i]),_=(0,s.useMemo)((()=>n?w:B),[n]),M=(0,s.useMemo)((()=>{const e=new Map;for(const n of _)e.set(n.id,n);return e}),[_]),[P,q]=(0,D.e)((()=>({userId:1,province:C.get(1).province,city:C.get(1).city,address:C.get(1).address,items:[{__rowId:1,productId:1,name:M.get(1).name,quantity:2},{__rowId:2,productId:10,name:M.get(10).name,quantity:1}]}))),Q=(0,s.useMemo)((()=>Math.max(...P.items.map((e=>e.__rowId)))+1),[P]),K=(0,s.useCallback)((e=>{const n=C.get(parseInt(e.target.value));void 0!==n&&q((e=>{e.userId=n.id,e.province=n.province,e.city=n.city,e.address=n.address}))}),[q,C]),G=(0,s.useCallback)((e=>{q((n=>{n.province=e.target.value}))}),[q]),U=(0,s.useCallback)((e=>{q((n=>{n.city=e.target.value}))}),[q]),F=(0,s.useCallback)((e=>{q((n=>{n.address=e.target.value}))}),[q]),H=(0,s.useCallback)(((e,n)=>{q((i=>{for(const s of i.items)if(s.__rowId===n){s.productId=parseInt(e.target.value),R(i);break}}))}),[q]),z=(0,s.useCallback)(((e,n)=>{q((i=>{for(const s of i.items)if(s.__rowId===n){s.quantity=parseInt(e.target.value),R(i);break}}))}),[q]),W=(0,s.useCallback)((e=>{q((n=>{for(let i=n.items.length-1;i>=0;--i)if(n.items[i].__rowId===e){n.items.splice(i,1);break}}))}),[q]),X=(0,s.useCallback)((()=>{q((e=>{e.items.push({__rowId:Q,quantity:1})}))}),[q,Q]),[J,Y]=(0,s.useState)(!1),V=(0,s.useCallback)((()=>{Y(!0)}),[]),Z=(0,s.useCallback)((()=>{Y(!1)}),[]);return(0,T.jsxs)(d.A,{elevation:3,style:{padding:"1.5rem"},children:[(0,T.jsx)(t.A,{component:"form",noValidate:!0,autoComplete:"off",children:(0,T.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,T.jsx)(c.Ay,{item:!0,xs:4,children:(0,T.jsx)(a.A,{fullWidth:!0,select:!0,label:n?"\u8d2d\u4e70\u4eba":"Purchaser",value:P.userId,onChange:K,children:i.map((e=>(0,T.jsx)(r.A,{value:e.id,children:e.nickName},e.id)))})}),(0,T.jsx)(c.Ay,{item:!0,xs:4,children:(0,T.jsx)(a.A,{fullWidth:!0,label:n?"\u7701\u4efd":"Province",value:P.province,onChange:G})}),(0,T.jsx)(c.Ay,{item:!0,xs:4,children:(0,T.jsx)(a.A,{fullWidth:!0,label:n?"\u57ce\u5e02":"City",value:P.city,onChange:U})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,children:(0,T.jsx)(a.A,{fullWidth:!0,label:n?"\u5730\u5740":"Address",value:P.address,onChange:F})}),(0,T.jsxs)(c.Ay,{item:!0,xs:12,children:[(0,T.jsx)(l.A,{textAlign:"left",children:n?"\u8ba2\u5355\u660e\u7ec6":"Order Items"}),(0,T.jsx)(j.A,{component:d.A,children:(0,T.jsxs)(h.A,{size:"small",children:[(0,T.jsx)(p.A,{children:(0,T.jsxs)(m.A,{children:[(0,T.jsx)(x.A,{children:n?"\u5546\u54c1":"Commodity"}),(0,T.jsx)(x.A,{children:n?"\u6570\u91cf":"Quantity"}),(0,T.jsx)(x.A,{children:n?"\u5355\u4ef7":"Unit price"}),(0,T.jsx)(x.A,{children:n?"\u660e\u7ec6\u4ef7":"Item price"}),(0,T.jsx)(x.A,{children:n?"\u5220\u9664":"Delete"})]})}),(0,T.jsx)(u.A,{children:P.items.map((e=>{const n=void 0!==e.productId?M.get(e.productId):void 0;return(0,T.jsxs)(m.A,{children:[(0,T.jsx)(x.A,{children:(0,T.jsx)(a.A,{select:!0,value:n?.id,variant:"standard",size:"small",onChange:n=>{H(n,e.__rowId)},children:_.map((e=>(0,T.jsx)(r.A,{value:e.id,children:e.name},e.id)))})}),(0,T.jsx)(x.A,{children:(0,T.jsx)(a.A,{type:"number",value:e.quantity,variant:"standard",size:"small",onChange:n=>{z(n,e.__rowId)}})}),(0,T.jsx)(x.A,{children:n?.price}),(0,T.jsx)(x.A,{children:void 0!==n&&n.price*e.quantity}),(0,T.jsx)(x.A,{children:(0,T.jsx)(b.A,{onClick:()=>W(e.__rowId),children:(0,T.jsx)(v.A,{})})})]},e.__rowId)}))}),(0,T.jsx)(g.A,{children:(0,T.jsx)(m.A,{children:(0,T.jsx)(x.A,{colSpan:5,children:(0,T.jsxs)(o.A,{onClick:X,children:[(0,T.jsx)(f.A,{}),n?"\u6dfb\u52a0":"Add"]})})})})]})})]}),(0,T.jsxs)(c.Ay,{item:!0,xs:12,children:[n?"\u603b\u989d":"Total price",":",P.items.filter((e=>void 0!==e.productId&&"number"==typeof e.quantity)).map((e=>M.get(e.productId).price*e.quantity)).reduce(((e,n)=>e+n),0)]}),(0,T.jsx)(c.Ay,{item:!0,xs:12,children:(0,T.jsx)(o.A,{variant:"contained",onClick:V,children:n?"\u63d0\u4ea4":"Submit"})})]})}),(0,T.jsxs)(y.A,{open:J,onClose:Z,children:[(0,T.jsx)(I.A,{children:n?"\u4fe1\u606f":"Info"}),(0,T.jsx)(A.A,{children:(0,T.jsx)(E.A,{children:n?"\u4ec5\u4f5c\u793a\u8303\uff0c\u65e0\u4efb\u4f55\u6548\u679c":"For demonstration only, without any effect"})}),(0,T.jsx)(k.A,{children:(0,T.jsx)(o.A,{onClick:Z,children:n?"\u5173\u95ed":"Close"})})]})]})})),L=[{id:1,nickName:"\u76ae\u76ae\u9c81",province:"\u56db\u5ddd",city:"\u6210\u90fd",address:"\u9f99\u6cc9\u9a7f\u533a\u6d2a\u7389\u8def\u4e0e\u5341\u6d2a\u8def\u4ea4\u53c9\u53e3"},{id:2,nickName:"\u9c81\u897f\u897f",province:"\u5e7f\u4e1c",city:"\u5e7f\u5dde",address:"\u767d\u4e91\u533a\u77f3\u6c99\u8def300\u53f7"},{id:3,nickName:"\u8212\u514b",province:"\u897f\u85cf",city:"\u62c9\u8428",address:"\u5806\u9f99\u5fb7\u5e86\u533a"},{id:4,nickName:"\u8d1d\u5854",province:"\u4e0a\u6d77",city:"\u4e0a\u6d77",address:"\u6d66\u4e1c\u65b0\u533a\u79c0\u6cbf\u897f\u8def218\u5f04"}],O=[{id:1,nickName:"Schneewittchen",province:"Berlin",city:"Prenzlauer Berg",address:"Brandenburgische Stra\xdfe 9, Prenzlauer Berg, Berlin, Germany"},{id:2,nickName:"Cinderella",province:"Basse-Normandie",city:"Lisieux",address:"20 rue L\xe9on Dierx, Lisieux, Basse-Normandie, France"},{id:3,nickName:"Nuwa",province:"ShanXi",city:"Taiyuan",address:"Qian Feng Nan Lu 99hao, Taiyuan, ShanXi, China"},{id:4,nickName:"Pinocchio",province:"Palazzo Pignano",city:"Cremona",address:"Via Giovanni Amendola 134, Palazzo Pignano, Cremona, Italy"}],w=[{id:1,name:"zippo\u591c\u5149\u6d41\u6c99\u6253\u706b\u673a",price:268},{id:2,name:"\u6770\u767b(Jayden)\u5370\u5ea6\u5854\u5e03\u62c9\u9f13",price:9238},{id:3,name:"\u6d6a\u7434(Longines)\u673a\u68b0\u624b\u8868",price:13900},{id:4,name:"viney\u7537\u58eb\u76ae\u5e26",price:139},{id:5,name:"\u96c5\u8bd7\u5170\u9edb\u7ed2\u96fe\u54d1\u5149\u5507\u818f",price:310},{id:6,name:"CIRCUIT\u7537\u5b50\u6ed1\u96ea\u5355\u677f",price:2044},{id:7,name:"\u7279\u4ed1\u82cf\u8131\u8102\u725b\u5976",price:47},{id:8,name:"\u4e50\u9ad8\u79ef\u6728\u5e03\u52a0\u8fea",price:374},{id:9,name:"\u53cc\u559c\u71c3\u6c14\u7535\u78c1\u901a\u7528\u538b\u529b\u9505",price:137},{id:10,name:"\u61a8\u61a8\u5ba0\u732b\u722c\u67b6",price:238}],B=[{id:1,name:"Timeless Vitamin C Plus E 10 Percent Ferulic Acid Serum Serum Unisex 1 oz",price:14.69},{id:2,name:"Dockers Men's Tiller Boat Shoe",price:52.41},{id:3,name:"Paxcoo 124 Skeins Embroidery Floss Cross Stitch Thread with Needles",price:29.99},{id:4,name:"Michael Kors Crossbody",price:70.6},{id:5,name:"Crocs unisex-child Classic Graphic Clog",price:34.99},{id:6,name:"Timex Time Machines Digital 35mm Watch",price:28.95},{id:7,name:"Scalex Mite & Lice Spray for Birds, 8 oz.",price:14.75},{id:8,name:"Under Armour Men's Storm Liner",price:13.03},{id:9,name:"Nike Women's Pro 3\" Training Shorts",price:35.86},{id:10,name:"Olaplex No. 4 Bond Maintenance Shampoo",price:30}];function R(e){const n=e.items,i=new Map;for(let s=0;s<n.length;s++){const e=n[s];if("number"!=typeof e.quantity)e.quantity=1;else if(e.quantity<1){n.splice(s--,1);continue}if(void 0===e.productId)continue;const t=i.get(e.productId);void 0===t?i.set(e.productId,e):(t.quantity+=e.quantity,n.splice(s--,1))}}},64087:(e,n,i)=>{i.d(n,{M:()=>b});var s=i(44586),t=i(31729),o=i(48440),a=i(80421),r=i(57416),c=i(18441),l=i(96125),d=i(43581),h=i(63051),u=i(46831),x=i(28968),j=i(15993),p=i(13407),m=i(67512),g=i(96540),f=i(74848);const b=(0,g.memo)((()=>{const[e,n]=(0,g.useState)((()=>({name:"Learning GraphQL",edition:1,price:45,storeId:1,authorIds:[1,2]}))),i=(0,g.useCallback)((e=>{n((n=>({...n,name:e.target.value})))}),[]),b=(0,g.useCallback)((e=>{n((n=>({...n,edition:e.target.valueAsNumber})))}),[]),v=(0,g.useCallback)((e=>{n((n=>({...n,price:e.target.valueAsNumber})))}),[]),y=(0,g.useCallback)((e=>{let i;const s=e.target.value;i="string"==typeof s?parseInt(s):s,-1===i&&(i=void 0),n((e=>({...e,storeId:i})))}),[]),k=(0,g.useCallback)((e=>{let i=[];console.log(e.target.value);const s=e.target.value;i="string"==typeof s?s.split(",").map((e=>parseInt(e))):s,n((e=>({...e,authorIds:i})))}),[]),{i18n:A}=(0,s.A)(),E=(0,g.useMemo)((()=>"zh"==A.currentLocale||"zh_cn"==A.currentLocale||"zh_CN"==A.currentLocale),[A.currentLocale]),[I,S]=(0,g.useState)(!1),D=(0,g.useCallback)((()=>{S(!0)}),[]),N=(0,g.useCallback)((()=>{S(!1)}),[]);return(0,f.jsxs)(r.A,{elevation:3,style:{padding:"1.5rem",width:500},children:[(0,f.jsxs)(l.A,{spacing:2,children:[(0,f.jsx)("h1",{children:"Book Form"}),(0,f.jsx)(d.A,{label:"Name",value:e.name,onChange:i,error:""===e.name,helperText:""===e.name?"Name is required":""}),(0,f.jsx)(d.A,{label:"Edition",type:"number",value:e.edition,onChange:b}),(0,f.jsx)(d.A,{label:"Price",type:"number",value:e.price,onChange:v}),(0,f.jsxs)(t.A,{fullWidth:!0,children:[(0,f.jsx)(o.A,{id:"store-select-label",children:"Store"}),(0,f.jsxs)(c.A,{labelId:"store-select-label",label:"Authors",value:e.storeId,onChange:y,children:[(0,f.jsx)(a.A,{value:-1,children:"--NONE--"}),(0,f.jsx)(a.A,{value:1,children:"O'REILLY"}),(0,f.jsx)(a.A,{value:2,children:"MANNING"})]})]}),(0,f.jsxs)(t.A,{fullWidth:!0,children:[(0,f.jsx)(o.A,{id:"author-multi-select-label",children:"Authors"}),(0,f.jsxs)(c.A,{multiple:!0,labelId:"author-multi-select-label",label:"Authors",value:e.authorIds,onChange:k,children:[(0,f.jsx)(a.A,{value:1,children:"Eve Procello"}),(0,f.jsx)(a.A,{value:2,children:"Alex Banks"}),(0,f.jsx)(a.A,{value:3,children:"Dan Vanderkam"}),(0,f.jsx)(a.A,{value:4,children:"Boris Cherny"}),(0,f.jsx)(a.A,{value:5,children:"Samer Buna"})]})]}),(0,f.jsx)(t.A,{children:(0,f.jsx)(m.A,{onClick:D,variant:"contained",children:E?"\u63d0\u4ea4":"Submit"})})]}),(0,f.jsxs)(h.A,{open:I,onClose:N,children:[(0,f.jsx)(u.A,{children:E?"\u4fe1\u606f":"Info"}),(0,f.jsx)(x.A,{children:(0,f.jsx)(p.A,{children:E?"\u4ec5\u4f5c\u793a\u8303\uff0c\u65e0\u4efb\u4f55\u6548\u679c":"For demonstration only, without any effect"})}),(0,f.jsx)(j.A,{children:(0,f.jsx)(m.A,{onClick:N,children:"\u5173\u95ed"})})]})]})}))},66971:(e,n,i)=>{i.d(n,{a:()=>p});var s=i(96540),t=i(72774),o=i(63051),a=i(28968),r=i(48875),c=i(44676),l=i(47859),d=i(4671),h=i(99343),u=i(7324),x=i(39781),j=i(74848);const p=(0,s.memo)((e=>{let{open:n,fullScreen:i=!1,title:r,maxWidth:p="md",onClose:g,children:f}=e;const[b,v]=(0,s.useState)(i),y=(0,s.useCallback)((()=>{v((e=>!e))}),[]);return(0,j.jsxs)(o.A,{open:n,onClose:g,fullScreen:b,TransitionComponent:m,maxWidth:p,children:[(0,j.jsx)(t.A,{sx:{position:"relative"},children:(0,j.jsxs)(c.A,{children:[(0,j.jsx)(l.A,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:r}),(0,j.jsx)(d.A,{onClick:y,style:{color:"white"},children:b?(0,j.jsx)(u.A,{}):(0,j.jsx)(h.A,{})}),(0,j.jsx)(d.A,{"aria-label":"close",onClick:g,style:{color:"white"},children:(0,j.jsx)(x.A,{})})]})}),(0,j.jsx)(a.A,{children:f})]})})),m=s.forwardRef((function(e,n){return(0,j.jsx)(r.A,{direction:"up",ref:n,...e})}))},74400:(e,n,i)=>{i.d(n,{l:()=>r});var s=i(96540),t=i(67512),o=i(66971),a=i(74848);const r=(0,s.memo)((e=>{let{buttonText:n,fullScreen:i=!1,title:r=n,variant:c="outlined",large:l=!1,maxWidth:d,useOriginalText:h=!0,children:u}=e;const[x,j]=(0,s.useState)(!1),p=(0,s.useCallback)((e=>{j(!0),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}),[]),m=(0,s.useCallback)((()=>{j(!1)}),[]),g=h?{textTransform:"none"}:{};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.A,{"data-is-view-more-button":"true",onClick:p,variant:c,size:l?"large":"small",style:g,children:n}),(0,a.jsx)(o.a,{open:x,onClose:m,title:r,maxWidth:d,fullScreen:i,children:u})]})}))},16712:(e,n,i)=>{i.d(n,{o:()=>t});var s=i(44586);function t(){const{i18n:e}=(0,s.A)(),n=e.currentLocale;return"zh"===n||"zh_cn"===n||"zh_CN"==n}}}]);